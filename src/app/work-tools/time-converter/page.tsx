'use client';
import {useState} from 'react';
import * as XLSX from 'xlsx';
export default function TimeConv(){const[i,setI]=useState('');const[r,setR]=useState<any[]>([]);function conv(){const n:any[]=[];i.split('\n').forEach((l,idx)=>{const m=l.match(/(\d+)h\s+(\d+)m/);if(m){const h=+m[1],mi=+m[2],d=h+mi/60;n.push({i:idx+1,t:+d.toFixed(2),o:+d.toFixed(2),l:false,f:false});}});setR(n);}function dl(){const ws=XLSX.utils.aoa_to_sheet([['#',...r.map(x=>x.i)],['Time',...r.map(x=>x.t)]]);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'S');XLSX.writeFile(wb,'Converted.xlsx');}return(<main className='p-8'><h1>Time Converter</h1><textarea value={i} onChange={ev=>setI(ev.target.value)} className='border w-full h-32'/><div className='space-x-2'><button onClick={conv} className='bg-indigo-600 text-white px-3 py-1'>Convert</button><button onClick={dl} className='border px-3 py-1'>Download</button></div><table className='border mt-2'><thead><tr><th>#</th><th>Time</th></tr></thead><tbody>{r.map((x,j)=>(<tr key={j}><td>{x.i}</td><td>{x.t}</td></tr>))}</tbody></table></main>);}
